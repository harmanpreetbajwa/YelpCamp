<% layout('layouts/boilerplate.ejs') %>
<div id="map" style="width: 100%; height: 500px"></div>
<h1>All Campgrounds</h1>

<% for (let campground of campgrounds) { %>
        <div class="card mb-2">
            <div class="row row-gap-3">
                <div class="col-md-4 py-1 px-3">
                    <% if (campground.images.length > 0){ %>
                        <img src="<%= campground.images[0].url %>" class="img-fluid rounded" alt="A campground image">
                    <% } %>
                </div>

                <div class="col-md-8">
                    <div class="card-body">
                        <h4 class="card-title"><%= campground.title %></h>
                        <h5  class="card-title text-muted"><%= campground.location %></h5>
                        <p class="card-text"><%= campground.description %></p>
                        <div class="d-flex align-items-center" style="gap: 20px; margin-top: 20px;">
                            <a href="/campgrounds/<%= campground.id %>" class="btn btn-primary">Show Details</a>
                        </div>
                    </div>
                </div>

            </div>
        </div>
<% } %>

<%- "<script>" %>
const maptilerApiKey = "<%- process.env.MAPTILER_API_KEY %>";
const campgrounds = {
  type: "FeatureCollection",
  features: <%- JSON.stringify(
    campgrounds.map(campground => ({
      type: "Feature",
      geometry: campground.geometry,
      properties: { popUpMarkup: campground?.properties?.popUpMarkup }
    }))
  ) %>
};
<%- "</script>" %>

<script src="/javascripts/clusterMap.js"></script>

